#!/usr/bin/haserl 
<%

case $POST_func in
  get_status)
    ndsctl status
    ;;
  get_clients)
    ntsctl clients
    ;;
  auth|deauth|block|unblock|allow|unallow|trust|untrust)
    func="$POST_func"
    macs="$POST_macs"
    fail=0
    for mac in $macs; do
      if [ `echo "$mac" | grep -c -E '^[[:xdigit:]]{1,2}(:[[:xdigit:]]{1,2}){5}$'` -eq 0 ]; then
        echo "(E) nodogsplash: Invalid MAC: '$mac'."
        exit
      fi
      
      echo -n "(I) nodogsplash: "
      ndsctl $func $mac
    done
    ;;
  *)
    echo "(E) nodogsplash: Invalid command: '$POST_func'"
    ;;
esac
%>
